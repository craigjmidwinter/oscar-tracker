(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{8920:(e,s,t)=>{Promise.resolve().then(t.bind(t,9639)),Promise.resolve().then(t.bind(t,7340)),Promise.resolve().then(t.bind(t,7645)),Promise.resolve().then(t.bind(t,6710)),Promise.resolve().then(t.bind(t,7003))},9639:(e,s,t)=>{"use strict";t.d(s,{CategoryList:()=>d});var i=t(5155),r=t(2115),n=t(8994),o=t(6710);function a(e){return(0,i.jsxs)("div",{className:"flex items-center justify-between mb-4 gap-2",children:[(0,i.jsx)("h2",{className:"text-lg font-semibold text-gray-800 whitespace-normal",children:e.name}),(0,i.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[(0,i.jsxs)("span",{className:"text-sm text-gray-500 whitespace-nowrap",children:[e.watched,"/",e.total]}),(0,i.jsx)("div",{className:"w-16 h-2 bg-gray-100 rounded-full",children:(0,i.jsx)("div",{className:"h-full bg-gradient-to-r from-blue-400 to-blue-600 rounded-full",style:{width:"".concat(e.progress,"%")}})})]})]})}function l(e){var s,t,r;let{category:n,seenMovies:o,updatePick:l,userPicks:d}=e,c=(null===(s=n.nominees)||void 0===s?void 0:s.length)||0,u=(null===(t=n.nominees)||void 0===t?void 0:t.filter(e=>o.has(e.movie.id)).length)||0,m=Math.round(u/c*100);return(0,i.jsxs)("div",{className:"break-inside-avoid bg-white rounded-xl shadow-lg p-4 mb-4 border border-gray-100",children:[(0,i.jsx)(a,{name:n.name,watched:u,total:c,progress:m}),(0,i.jsx)("div",{className:"space-y-2",children:null===(r=n.nominees)||void 0===r?void 0:r.map(e=>{var s,t;return(0,i.jsxs)("div",{className:"group p-3 rounded-lg flex items-start justify-between ".concat(o.has(e.movie.id)?"bg-green-50 border border-green-200":"bg-gray-50 hover:bg-gray-100"),children:[(0,i.jsxs)("div",{className:"flex-1 min-w-0 mr-2",children:[(0,i.jsx)("h3",{className:"text-sm font-medium text-gray-900 whitespace-normal",children:e.name}),(0,i.jsx)("p",{className:"text-xs text-gray-500 whitespace-normal mt-1",children:e.movie.title})]}),(0,i.jsxs)("div",{className:"flex gap-1 flex-shrink-0",children:[(0,i.jsx)("button",{onClick:()=>l(n.id,e.id,"think"),className:"p-2 rounded-md transition-colors ".concat((null===(s=d[n.id])||void 0===s?void 0:s.think)===e.id?"bg-blue-500 text-white":"bg-gray-200 text-gray-600 hover:bg-blue-100"),children:(0,i.jsx)("span",{className:"text-sm block",children:"\uD83E\uDDE0"})}),(0,i.jsx)("button",{onClick:()=>l(n.id,e.id,"hope"),className:"p-2 rounded-md transition-colors ".concat((null===(t=d[n.id])||void 0===t?void 0:t.hope)===e.id?"bg-pink-500 text-white":"bg-gray-200 text-gray-600 hover:bg-pink-100"),children:(0,i.jsx)("span",{className:"text-sm block",children:"❤️"})})]})]},e.id)})})]},n.id)}function d(e){let{nominees:s,seenMovies:t}=e,{user:a}=(0,o.A)(),[d,c]=(0,r.useState)({});(0,r.useEffect)(()=>{(null==a?void 0:a.id)&&(async()=>{let{data:e,error:s}=await n.ND.from("user_picks").select("category_id, think_will_win, hope_will_win").eq("user_id",a.id);if(s){console.error("Error fetching user picks:",s);return}c(e.reduce((e,s)=>({...e,[s.category_id]:{think:s.think_will_win,hope:s.hope_will_win}}),{}))})()},[null==a?void 0:a.id]);let u=async(e,s,t)=>{if(null==a?void 0:a.id){c(i=>{var r;return{...i,[e]:{...i[e],[t]:(null===(r=i[e])||void 0===r?void 0:r[t])===s?null:s}}});try{var i,r,o,l;await n.ND.from("user_picks").upsert({user_id:a.id,category_id:e,think_will_win:"think"===t?(null===(i=d[e])||void 0===i?void 0:i.think)===s?null:s:null===(r=d[e])||void 0===r?void 0:r.think,hope_will_win:"hope"===t?(null===(o=d[e])||void 0===o?void 0:o.hope)===s?null:s:null===(l=d[e])||void 0===l?void 0:l.hope})}catch(e){console.error("Failed to update pick:",e)}}},m=Array.from(s.reduce((e,s)=>{let t=s.category;if(!e.has(t.id)){var i,r;e.set(t.id,{id:t.id,name:t.name,created_at:null!==(i=t.created_at)&&void 0!==i?i:null,type:null!==(r=t.type)&&void 0!==r?r:null,nominees:[]})}return e.get(t.id).nominees.push(s),e},new Map).values());return(0,i.jsx)("div",{className:"columns-1 md:columns-2 lg:columns-3 gap-4 p-4 w-full space-y-4",children:m.map((e,s)=>(0,i.jsx)(l,{category:e,seenMovies:t,updatePick:u,userPicks:d},s))})}},7340:(e,s,t)=>{"use strict";t.d(s,{Layout:()=>l});var i=t(5155),r=t(2115),n=t(6710);function o(e){let{onClose:s}=e,{user:t,signIn:o}=(0,n.A)(),[a,l]=(0,r.useState)(""),[d,c]=(0,r.useState)(!1),[u,m]=(0,r.useState)(""),[h,x]=(0,r.useState)("");(0,r.useEffect)(()=>{t&&s()},[t,s]);let g=async e=>{if(e.preventDefault(),x(""),m(""),!a.match(/^\S+@\S+\.\S+$/)){x("Please enter a valid email address");return}c(!0);try{if(await o(a),h)throw h;m("Check your email for the login link!"),setTimeout(s,3e3)}catch(e){console.error("Login error:",e),x("Failed to send login link. Please try again.")}finally{c(!1)}};return t?null:(0,i.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50 backdrop-blur-sm",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full overflow-hidden",children:[(0,i.jsx)("div",{className:"px-6 py-4 border-b border-gray-100",children:(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Sign In"}),(0,i.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,i.jsx)("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,i.jsxs)("div",{className:"px-6 py-4",children:[(0,i.jsxs)("form",{onSubmit:g,className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),(0,i.jsx)("input",{type:"email",id:"email",value:a,onChange:e=>{l(e.target.value),x("")},placeholder:"Enter your email",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",required:!0})]}),h&&(0,i.jsxs)("div",{className:"text-sm text-red-600 bg-red-50 px-3 py-2 rounded-md",children:["⚠️ ",h]}),(0,i.jsx)("button",{type:"submit",disabled:d,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Sending login link...":"Send Login Link"})]}),u&&(0,i.jsxs)("div",{className:"mt-4 text-sm text-green-600 bg-green-50 px-3 py-2 rounded-md",children:["✅ ",u]})]}),(0,i.jsx)("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-100",children:(0,i.jsx)("p",{className:"text-sm text-gray-500",children:"We&pos;ll send you a magic link to sign in. No password required."})})]})})}var a=t(7003);function l(e){var s;let{MovieListComponent:t,CategoryListComponent:l,nominees:d}=e,{user:c,signOut:u}=(0,n.A)(),{seenMovies:m,toggleMovieSeen:h}=(0,a.U)(),[x,g]=(0,r.useState)(!1);return(0,i.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[x&&(0,i.jsx)(o,{onClose:()=>g(!1)}),(0,i.jsx)("header",{className:"bg-white shadow-sm",children:(0,i.jsxs)("div",{className:"container mx-auto px-4 py-3 flex justify-between items-center",children:[(0,i.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"\uD83C\uDFC6 Awards Tracker"}),(0,i.jsx)("div",{className:"flex items-center gap-3",children:c?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("span",{className:"text-sm text-gray-700 bg-gray-100 px-3 py-1.5 rounded-full",children:["\uD83D\uDC4B ",null===(s=c.email)||void 0===s?void 0:s.split("@")[0]]}),(0,i.jsx)("button",{onClick:u,className:"text-sm text-gray-700 hover:text-gray-900 bg-gray-100 hover:bg-gray-200 px-3 py-1.5 rounded-full transition-colors",children:"Sign Out"})]}):(0,i.jsx)("button",{onClick:()=>g(!0),className:"text-sm text-white bg-blue-600 hover:bg-blue-700 px-3 py-1.5 rounded-full transition-colors",children:"Sign In"})})]})}),(0,i.jsx)("main",{className:"container mx-auto px-4 py-6",children:(0,i.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-[300px_1fr] gap-6",children:[(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100",children:[(0,i.jsx)("div",{className:"p-4 border-b border-gray-100",children:(0,i.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"\uD83C\uDFAC Movie List"})}),(0,i.jsx)("div",{className:"p-4",children:(0,i.jsx)(t,{seenMovies:m,toggleMovieSeen:h,nominees:d})})]}),(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100",children:[(0,i.jsx)("div",{className:"p-4 border-b border-gray-100",children:(0,i.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"\uD83C\uDFC5 Categories"})}),(0,i.jsx)("div",{className:"p-4",children:(0,i.jsx)(l,{seenMovies:m,nominees:d})})]})]})})]})}},7645:(e,s,t)=>{"use strict";t.d(s,{MovieList:()=>n});var i=t(5155),r=t(2115);function n(e){let{seenMovies:s,toggleMovieSeen:t,nominees:n}=e,o=new Map;n.forEach(e=>{let s=e.movie;o.has(s.id)?o.get(s.id).nominationCount+=1:o.set(s.id,{id:s.id,title:s.title,nominationCount:1})});let a=Array.from(o.values()),[l,d]=(0,r.useState)("nominations"),c=[...a].sort((e,s)=>"nominations"===l?s.nominationCount-e.nominationCount:e.title.localeCompare(s.title));return(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-4 pb-3 border-b border-gray-200",children:[(0,i.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Sort by:"}),(0,i.jsxs)("select",{className:"text-sm text-gray-700 bg-white border border-gray-300 rounded-md px-2 py-1 hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",value:l,onChange:e=>d(e.target.value),children:[(0,i.jsx)("option",{value:"nominations",children:"Most Nominations"}),(0,i.jsx)("option",{value:"title",children:"Title (A-Z)"})]})]}),(0,i.jsx)("div",{className:"space-y-2",children:c.map(e=>(0,i.jsxs)("div",{role:"button",tabIndex:0,className:"group p-3 rounded-lg flex items-center justify-between cursor-pointer\n                        transition-all outline-none ".concat(s.has(e.id)?"bg-green-50 border border-green-200":"bg-white hover:bg-gray-50 border border-gray-200"),onClick:()=>t(e.id),onKeyDown:s=>"Enter"===s.key&&t(e.id),children:[(0,i.jsxs)("div",{className:"flex-1 min-w-0 mr-2",children:[(0,i.jsx)("h3",{className:"text-sm font-medium text-gray-900 truncate",children:e.title}),(0,i.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[e.nominationCount," nomination",e.nominationCount>1?"s":""]})]}),(0,i.jsx)("div",{className:"flex-shrink-0",children:(0,i.jsxs)("div",{className:"w-5 h-5 border rounded-md flex items-center justify-center\n                                transition-colors ".concat(s.has(e.id)?"border-green-500 bg-green-500":"border-gray-300 group-hover:border-gray-400 bg-white"),onClick:s=>{s.stopPropagation(),t(e.id)},children:[(0,i.jsx)("input",{type:"checkbox",checked:s.has(e.id),onChange:s=>{s.stopPropagation(),t(e.id)},className:"opacity-0 absolute"}),s.has(e.id)&&(0,i.jsx)("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]})})]},e.id))})]})}},7003:(e,s,t)=>{"use strict";t.d(s,{SeenMoviesProvider:()=>l,U:()=>d});var i=t(5155),r=t(2115),n=t(8994),o=t(6710);let a=(0,r.createContext)(void 0);function l(e){let{children:s}=e,{user:t}=(0,o.A)(),[l,d]=(0,r.useState)(new Set);(0,r.useEffect)(()=>{(async()=>{if(t){let{data:e,error:s}=await n.ND.from("user_seen_movies").select("movie_id").eq("user_id",t.id);if(s){console.error("Failed to load seen movies:",s);return}d(new Set(e.map(e=>e.movie_id)))}else d(new Set(JSON.parse(localStorage.getItem("seenMovies")||"[]")))})()},[t]);let c=async e=>{if(d(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),new Set(t)}),t)try{l.has(e)?await n.ND.from("user_seen_movies").delete().eq("user_id",t.id).eq("movie_id",e):await n.ND.from("user_seen_movies").insert([{user_id:t.id,movie_id:e}])}catch(e){console.error("Failed to update movie status:",e)}else localStorage.setItem("seenMovies",JSON.stringify([...l]))};return(0,i.jsx)(a.Provider,{value:{seenMovies:l,setSeenMovies:d,toggleMovieSeen:c},children:s})}function d(){let e=(0,r.useContext)(a);if(!e)throw Error("useSeenMovies must be used within a SeenMoviesProvider");return e}},6710:(e,s,t)=>{"use strict";t.d(s,{A:()=>l,AuthProvider:()=>a});var i=t(5155),r=t(2115),n=t(8994);let o=(0,r.createContext)(void 0);function a(e){let{children:s}=e,[t,a]=(0,r.useState)(null),[l,d]=(0,r.useState)(!0),c=(0,r.useMemo)(()=>({user:t,signIn:async e=>{let{error:s}=await n.ND.auth.signInWithOtp({email:e,options:{emailRedirectTo:"".concat(location.origin,"/auth/callback")}});if(s)throw s},signOut:async()=>{await n.ND.auth.signOut(),a(null),localStorage.removeItem("seenMovies"),localStorage.removeItem("picks")}}),[t]);return((0,r.useEffect)(()=>{(async()=>{var e;let{data:{session:s}}=await n.ND.auth.getSession();a(null!==(e=null==s?void 0:s.user)&&void 0!==e?e:null),d(!1)})();let{data:{subscription:e}}=n.ND.auth.onAuthStateChange(async(e,s)=>{var t;a(null!==(t=null==s?void 0:s.user)&&void 0!==t?t:null)});return()=>null==e?void 0:e.unsubscribe()},[]),l)?(0,i.jsx)("div",{children:"Loading..."}):(0,i.jsx)(o.Provider,{value:c,children:s})}function l(){let e=(0,r.useContext)(o);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},8994:(e,s,t)=>{"use strict";t.d(s,{ND:()=>i});let i=(0,t(5974).UU)("postgresql://postgres:r64hti8SdGpomLe7@db.ekmhsnwsdpjpxznopwkp.supabase.co:5432/postgres","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVrbWhzbndzZHBqcHh6bm9wd2twIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzk0NjU3MTUsImV4cCI6MjA1NTA0MTcxNX0.rDW5AjPCD0-xF00F7abJNolEroseW_rO76wZ8wSdB-8",{auth:{storage:localStorage,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}})}},e=>{var s=s=>e(e.s=s);e.O(0,[736,441,517,358],()=>s(8920)),_N_E=e.O()}]);